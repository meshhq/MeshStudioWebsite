<!DOCTYPE html>
<html lang="en-us">

<!DOCTYPE html>
<html lang="en-us">

<head>
    
    <link rel="shortcut icon" href="https://meshstudio.io/images/site/favicon/favicon.png">
    <link rel="apple-touch-icon" href="https://meshstudio.io/images/site/favicon/favicon.png" />

    
    <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />

<meta property="og:title" content=" Serving HTML with Golang &middot;  Mesh Studio" />
<meta property="og:site_name" content="Mesh Studio" />
<meta property="og:url" content="https://meshstudio.io/blog/2017-11-06-serving-html-with-golang/" />


<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:domain" value="meshstudio.io" />
<meta name="twitter:title" value="Mesh Studio" />
<meta name="twitter:description" value="We’re Mesh, a Seattle based software development consultancy. We help innovative companies ship incredible software products." />
<meta name="twitter:image" content="https://meshstudio.io/images/site/twitter_logo.jpg">
<meta name="twitter:url" value="https://meshstudio.io/" />
<meta name="twitter:label1" value="Cloud Development" />
<meta name="twitter:label2" value="Application Development" />


  <meta property="og:type" content="article" />

<meta property="og:article:published_time" content="2017-11-06T10:09:12-08:00" />


<meta property="og:article:tag" content="Go" />

<meta property="og:article:tag" content="WebApp" />

<meta property="og:article:tag" content="Programming" />




  <meta property="og:image" content="/images/blog/2017-11-06-serving-html-with-golang/hero.jpg" />


<title>
 Serving HTML with Golang &middot;  Mesh Studio
</title>

<meta name="description" content="We’re Mesh, a Seattle based software development consultancy. We help innovative companies ship incredible software products." />

<meta name="HandheldFriendly" content="True" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

    

    <link rel="apple-touch-icon" sizes="57x57" href="/images/site/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images/site/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/site/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images/site/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/site/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images/site/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images/site/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/site/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/site/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/images/site/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/site/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/site/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/site/favicon/favicon-16x16.png">
<link rel="manifest" href="/images/site/favicon/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
    
    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="https://meshstudio.io/css/main.css" />
    <link rel="stylesheet" href="https://use.typekit.net/qxb4anb.css">
    <link rel="stylesheet" type="text/css" href="https://cloud.typography.com/6268016/6917392/css/fonts.css" />

    
    
      
          <link href="https://meshstudio.io/index.xml" rel="alternate" type="application/rss+xml" title="Mesh Studio" />
      
      
    
    <meta name="generator" content="Hugo 0.37.1" />

    <link rel="canonical" href="https://meshstudio.io/blog/2017-11-06-serving-html-with-golang/" />

</head>
<body class="nav-closed">

  <div class="container" id="container">
    <nav class="navbar navbar-expand-md navbar-light">

        
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03"
            aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        
        
        <a class="navbar-brand" href="https://meshstudio.io/">
            <img class="img-fluid main-logo" src="/images/site/meshlogo-black-vector.svg" alt="Home" />
        </a>

        
        <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
            <form class="form-inline ml-auto my-2 my-lg-0">
                <ul class="navbar-nav">
                    
                     
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/work/">Work</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/services/">Services</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/about/">About</a>
                    </li>
                    
                    <li class="nav-item">
                        <a class="nav-link" href="/careers/">Careers</a>
                    </li>
                    
                    <li class="nav-item active">
                        <a class="nav-link" href="/blog/">Blog</a>
                    </li>
                    
                </ul>
            </form>
        </div>

    </nav>
</div>



<body class="nav-closed">
    <img class="seattle-rain" src="/images/site/rain.svg" alt="Home" />
    <main id="content" class="content" role="main">

        

<div class="blog-post">
    <div class="hero">
        <div class="container">
            <div class="row d-flex flex-row align-items-center justify-content-center">
                <div class="row justify-content-center hero-title-block">
    <div class="col-12">
        <div class="d-flex justify-content-center">
            <h2>Serving HTML with Golang</h2>
        </div>
    </div>
    <div class="col-12 mt-2">
        <div class="d-flex justify-content-center">
            <h3>How to write your next web app in Golang!</h3>
        </div>
    </div>
</div>
            </div>
        </div>
    </div>

    <div class="primary-section">
        <div class="hero-container d-flex justify-content-center">
            <img class="img-fluid" src="/images/blog/2017-11-06-serving-html-with-golang/hero.jpg" />
        </div>

        <div class="container">
            
            <div class="row">
                <div class="col-10 offset-1 post-container">
                    <div class="row blog-meta-row">
                        <div class="col-10 offset-1">
                            <header class="meta-header d-flex flex-column align-items-center">
                                <div class="author-picture">
                                    <a class="founder-twitter" href="http://johnmcdaly.com/">
                                        <img class="img-fluid author-pic rounded-circle" src="https://avatars2.githubusercontent.com/u/1719443?s=460&amp;v=4" />
                                    </a>
                                </div>
                                <div class="author-meta mt-2">
                                    <span class="post-meta author-name">John Daly</span>
                                    <span class="post-meta post-date">Posted On Nov 6, 2017</span>
                                    <p class="post-meta post-words mt-1">11 min read | 2400 Words</p>
                                </div>
                            </header>
                        </div>
                    </div>
                    <div class="row blog-content-row">
                        <div class="col-10 offset-1">
                            <article class="post">
                                

<p>Here at Mesh, we like to keep up-to-date with the latest trends in software development; often trying out various programming languages and frameworks. One of the languages that we like to use is <a href="http://golang.org">Go</a>. We appreciate that Go is strongly-typed, is opinionated about formatting, and is strict about keeping the structure of programs simple. It is also quite a versatile language, so in this post we will explore how it can be used to create an HTML server using <a href="http://github.com/gorilla/mux">gorilla/mux</a>, <a href="http://github.com/jteeuwen/go-bindata">jteeuwen/go-bindata</a>, and <a href="https://golang.org/pkg/html/template/">html/template</a>.</p>

<p>Check out the source of this project here: <a href="https://github.com/meshhq/golang-html-template-tutorial">https://github.com/meshhq/golang-html-template-tutorial</a></p>

<h3 id="project-structure">Project Structure</h3>

<pre><code>// Auto-generated files to bundle templates/style-sheets together
- assets
  - assets.go
  - bindata.go

// Static files, which will be style-sheets for this project
- static
  - navigation_bar.css
  - style.css
  - third_view.css

// HTML templates, which will be rendered and served
- templates
  - index.html
  - navigation_bar.html
  - second_view.html
  - third_view.html

// Bulk of logic goes here
- main.go

// Route-specific logic for the third_view template
- third_view.go
</code></pre>

<p>The bulk of the logic for this project will be in the <code>main.go</code> file, which consists of the following pieces:</p>

<ol>
<li>Initialization of HTML Templates</li>
<li>Configuration of the Server</li>
<li>Starting and Stopping the Server</li>
<li>Route Handling and Rendering Templates</li>
</ol>

<p>Let’s dive into these!</p>

<h3 id="initialization-of-html-templates">Initialization of HTML Templates</h3>

<p>At the top of our main.go file, we will declare and initialize the HTML templates:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// Templates
</span><span class="c1"></span><span class="kd">var</span> <span class="nx">navigationBarHTML</span> <span class="kt">string</span>
<span class="kd">var</span> <span class="nx">homepageTpl</span> <span class="o">*</span><span class="nx">template</span><span class="p">.</span><span class="nx">Template</span>
<span class="kd">var</span> <span class="nx">secondViewTpl</span> <span class="o">*</span><span class="nx">template</span><span class="p">.</span><span class="nx">Template</span>
<span class="kd">var</span> <span class="nx">thirdViewTpl</span> <span class="o">*</span><span class="nx">template</span><span class="p">.</span><span class="nx">Template</span>

<span class="kd">func</span> <span class="nx">init</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">navigationBarHTML</span> <span class="p">=</span> <span class="nx">assets</span><span class="p">.</span><span class="nx">MustAssetString</span><span class="p">(</span><span class="s">&#34;templates/navigation_bar.html&#34;</span><span class="p">)</span>

	<span class="nx">homepageHTML</span> <span class="o">:=</span> <span class="nx">assets</span><span class="p">.</span><span class="nx">MustAssetString</span><span class="p">(</span><span class="s">&#34;templates/index.html&#34;</span><span class="p">)</span>
	<span class="nx">homepageTpl</span> <span class="p">=</span> <span class="nx">template</span><span class="p">.</span><span class="nx">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&#34;homepage_view&#34;</span><span class="p">).</span><span class="nx">Parse</span><span class="p">(</span><span class="nx">homepageHTML</span><span class="p">))</span>

	<span class="nx">secondViewHTML</span> <span class="o">:=</span> <span class="nx">assets</span><span class="p">.</span><span class="nx">MustAssetString</span><span class="p">(</span><span class="s">&#34;templates/second_view.html&#34;</span><span class="p">)</span>
	<span class="nx">secondViewTpl</span> <span class="p">=</span> <span class="nx">template</span><span class="p">.</span><span class="nx">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&#34;second_view&#34;</span><span class="p">).</span><span class="nx">Parse</span><span class="p">(</span><span class="nx">secondViewHTML</span><span class="p">))</span>

	<span class="nx">thirdViewFuncMap</span> <span class="o">:=</span> <span class="nx">ThirdViewFormattingFuncMap</span><span class="p">()</span>
	<span class="nx">thirdViewHTML</span> <span class="o">:=</span> <span class="nx">assets</span><span class="p">.</span><span class="nx">MustAssetString</span><span class="p">(</span><span class="s">&#34;templates/third_view.html&#34;</span><span class="p">)</span>
	<span class="nx">thirdViewTpl</span> <span class="p">=</span> <span class="nx">template</span><span class="p">.</span><span class="nx">Must</span><span class="p">(</span><span class="nx">template</span><span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&#34;third_view&#34;</span><span class="p">).</span><span class="nx">Funcs</span><span class="p">(</span><span class="nx">thirdViewFuncMap</span><span class="p">).</span><span class="nx">Parse</span><span class="p">(</span><span class="nx">thirdViewHTML</span><span class="p">))</span>
<span class="p">}</span></code></pre></div>
<p>The templates are loaded in from the <code>assets/bindata.go</code> file, which is a file that includes all the HTML and CSS information for the app; it is auto-generated using the <code>jteeuwen/go-bindata</code> utility. You will notice that <code>thirdViewTpl</code> includes a function map called <code>thirdViewFuncMap</code>, this will be discussed further in a bit.</p>

<h3 id="configuration-of-the-server">Configuration of the Server</h3>

<p>Next we will fill out the <code>main()</code> function, which consists of setting up the server configuration, starting the server, and listening for a signal to stop the program:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="nx">serverCfg</span> <span class="o">:=</span> <span class="nx">Config</span><span class="p">{</span>
		<span class="nx">Host</span><span class="p">:</span>         <span class="s">&#34;localhost:5000&#34;</span><span class="p">,</span>
		<span class="nx">ReadTimeout</span><span class="p">:</span>  <span class="mi">5</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span>
		<span class="nx">WriteTimeout</span><span class="p">:</span> <span class="mi">5</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span><span class="p">,</span>
	<span class="p">}</span>
	<span class="nx">htmlServer</span> <span class="o">:=</span> <span class="nx">Start</span><span class="p">(</span><span class="nx">serverCfg</span><span class="p">)</span>
	<span class="k">defer</span> <span class="nx">htmlServer</span><span class="p">.</span><span class="nx">Stop</span><span class="p">()</span>

	<span class="nx">sigChan</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="kd">chan</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Signal</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
	<span class="nx">signal</span><span class="p">.</span><span class="nx">Notify</span><span class="p">(</span><span class="nx">sigChan</span><span class="p">,</span> <span class="nx">os</span><span class="p">.</span><span class="nx">Interrupt</span><span class="p">)</span>
	<span class="o">&lt;-</span><span class="nx">sigChan</span>

	<span class="nx">fmt</span><span class="p">.</span><span class="nx">Println</span><span class="p">(</span><span class="s">&#34;main : shutting down&#34;</span><span class="p">)</span>
<span class="p">}</span></code></pre></div>
<p>Notice that we are setting the ‘Host’ of the configuration to be ‘localhost:5000’, you can change this to whatever you like.</p>

<h3 id="starting-the-server">Starting the Server</h3>

<p>To start the server, we create a function that will set-up the router, create the server object, and then start a listener:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// Start launches the HTML Server
</span><span class="c1"></span><span class="kd">func</span> <span class="nx">Start</span><span class="p">(</span><span class="nx">cfg</span> <span class="nx">Config</span><span class="p">)</span> <span class="o">*</span><span class="nx">HTMLServer</span> <span class="p">{</span>
	<span class="c1">// Setup Context
</span><span class="c1"></span>	<span class="nx">_</span><span class="p">,</span> <span class="nx">cancel</span> <span class="o">:=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">WithCancel</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">())</span>
	<span class="k">defer</span> <span class="nx">cancel</span><span class="p">()</span>

	<span class="c1">// Setup Handlers
</span><span class="c1"></span>	<span class="nx">router</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">NewRouter</span><span class="p">()</span>
	<span class="nx">router</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span> <span class="nx">HomeHandler</span><span class="p">)</span>
	<span class="nx">router</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&#34;/second&#34;</span><span class="p">,</span> <span class="nx">SecondHandler</span><span class="p">)</span>
	<span class="nx">router</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&#34;/third/{number}&#34;</span><span class="p">,</span> <span class="nx">ThirdHandler</span><span class="p">)</span>
	<span class="nx">router</span><span class="p">.</span><span class="nx">PathPrefix</span><span class="p">(</span><span class="s">&#34;/static/&#34;</span><span class="p">).</span><span class="nx">Handler</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">StripPrefix</span><span class="p">(</span><span class="s">&#34;/static/&#34;</span><span class="p">,</span> <span class="nx">http</span><span class="p">.</span><span class="nx">FileServer</span><span class="p">(</span><span class="nx">http</span><span class="p">.</span><span class="nx">Dir</span><span class="p">(</span><span class="s">&#34;./static&#34;</span><span class="p">))))</span>

	<span class="c1">// Create the HTML Server
</span><span class="c1"></span>	<span class="nx">htmlServer</span> <span class="o">:=</span> <span class="nx">HTMLServer</span><span class="p">{</span>
		<span class="nx">server</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">http</span><span class="p">.</span><span class="nx">Server</span><span class="p">{</span>
			<span class="nx">Addr</span><span class="p">:</span>           <span class="nx">cfg</span><span class="p">.</span><span class="nx">Host</span><span class="p">,</span>
			<span class="nx">Handler</span><span class="p">:</span>        <span class="nx">router</span><span class="p">,</span>
			<span class="nx">ReadTimeout</span><span class="p">:</span>    <span class="nx">cfg</span><span class="p">.</span><span class="nx">ReadTimeout</span><span class="p">,</span>
			<span class="nx">WriteTimeout</span><span class="p">:</span>   <span class="nx">cfg</span><span class="p">.</span><span class="nx">WriteTimeout</span><span class="p">,</span>
			<span class="nx">MaxHeaderBytes</span><span class="p">:</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">20</span><span class="p">,</span>
		<span class="p">},</span>
	<span class="p">}</span>

	<span class="c1">// Add to the WaitGroup for the listener goroutine
</span><span class="c1"></span>	<span class="nx">htmlServer</span><span class="p">.</span><span class="nx">wg</span><span class="p">.</span><span class="nx">Add</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

	<span class="c1">// Start the listener
</span><span class="c1"></span>	<span class="k">go</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&#34;\nHTMLServer : Service started : Host=%v\n&#34;</span><span class="p">,</span> <span class="nx">cfg</span><span class="p">.</span><span class="nx">Host</span><span class="p">)</span>
		<span class="nx">htmlServer</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">ListenAndServe</span><span class="p">()</span>
		<span class="nx">htmlServer</span><span class="p">.</span><span class="nx">wg</span><span class="p">.</span><span class="nx">Done</span><span class="p">()</span>
	<span class="p">}()</span>

	<span class="k">return</span> <span class="o">&amp;</span><span class="nx">htmlServer</span>
<span class="p">}</span></code></pre></div>
<p>An important thing to take note of here is the router setup. You can see that we are setting up four total routes; the first three are responsible for rendering the appropriate HTML templates, and the fourth one will serve up files that live in the <code>/static</code> folder. These static files will consist of the CSS files for our project.</p>

<h3 id="stopping-the-server">Stopping the Server</h3>

<p>To stop the server, we attempt to gracefully shut it down with a timeout. If the shutdown process does not finish within this timeout, then we force close the server:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// Stop turns off the HTML Server
</span><span class="c1"></span><span class="kd">func</span> <span class="p">(</span><span class="nx">htmlServer</span> <span class="o">*</span><span class="nx">HTMLServer</span><span class="p">)</span> <span class="nx">Stop</span><span class="p">()</span> <span class="kt">error</span> <span class="p">{</span>
	<span class="c1">// Create a context to attempt a graceful 5 second shutdown.
</span><span class="c1"></span>	<span class="kd">const</span> <span class="nx">timeout</span> <span class="p">=</span> <span class="mi">5</span> <span class="o">*</span> <span class="nx">time</span><span class="p">.</span><span class="nx">Second</span>
	<span class="nx">ctx</span><span class="p">,</span> <span class="nx">cancel</span> <span class="o">:=</span> <span class="nx">context</span><span class="p">.</span><span class="nx">WithTimeout</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">Background</span><span class="p">(),</span> <span class="nx">timeout</span><span class="p">)</span>
	<span class="k">defer</span> <span class="nx">cancel</span><span class="p">()</span>

	<span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&#34;\nHTMLServer : Service stopping\n&#34;</span><span class="p">)</span>

	<span class="c1">// Attempt the graceful shutdown by closing the listener
</span><span class="c1"></span>	<span class="c1">// and completing all inflight requests
</span><span class="c1"></span>	<span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">htmlServer</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">Shutdown</span><span class="p">(</span><span class="nx">ctx</span><span class="p">);</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="c1">// Looks like we timed out on the graceful shutdown. Force close.
</span><span class="c1"></span>		<span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">htmlServer</span><span class="p">.</span><span class="nx">server</span><span class="p">.</span><span class="nx">Close</span><span class="p">();</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&#34;\nHTMLServer : Service stopping : Error=%v\n&#34;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
			<span class="k">return</span> <span class="nx">err</span>
		<span class="p">}</span>
	<span class="p">}</span>

	<span class="c1">// Wait for the listener to report that it is closed.
</span><span class="c1"></span>	<span class="nx">htmlServer</span><span class="p">.</span><span class="nx">wg</span><span class="p">.</span><span class="nx">Wait</span><span class="p">()</span>
	<span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&#34;\nHTMLServer : Stopped\n&#34;</span><span class="p">)</span>
	<span class="k">return</span> <span class="kc">nil</span>
<span class="p">}</span></code></pre></div>
<h3 id="route-handling-and-rendering-templates">Route Handling and Rendering Templates</h3>

<p>The code that actually renders the HTML templates happens here:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// HomeHandler renders the homepage view template
</span><span class="c1"></span><span class="kd">func</span> <span class="nx">HomeHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/style.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/navigation_bar.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&#34;Content-Type&#34;</span><span class="p">,</span> <span class="s">&#34;text/html; charset=utf-8&#34;</span><span class="p">)</span>

	<span class="nx">fullData</span> <span class="o">:=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
		<span class="s">&#34;NavigationBar&#34;</span><span class="p">:</span> <span class="nx">template</span><span class="p">.</span><span class="nx">HTML</span><span class="p">(</span><span class="nx">navigationBarHTML</span><span class="p">),</span>
	<span class="p">}</span>
	<span class="nx">render</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">homepageTpl</span><span class="p">,</span> <span class="s">&#34;homepage_view&#34;</span><span class="p">,</span> <span class="nx">fullData</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// SecondHandler renders the second view template
</span><span class="c1"></span><span class="kd">func</span> <span class="nx">SecondHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/style.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/navigation_bar.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&#34;Content-Type&#34;</span><span class="p">,</span> <span class="s">&#34;text/html; charset=utf-8&#34;</span><span class="p">)</span>

	<span class="nx">fullData</span> <span class="o">:=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
		<span class="s">&#34;NavigationBar&#34;</span><span class="p">:</span> <span class="nx">template</span><span class="p">.</span><span class="nx">HTML</span><span class="p">(</span><span class="nx">navigationBarHTML</span><span class="p">),</span>
	<span class="p">}</span>
	<span class="nx">render</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">secondViewTpl</span><span class="p">,</span> <span class="s">&#34;second_view&#34;</span><span class="p">,</span> <span class="nx">fullData</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// ThirdHandler renders the third view template
</span><span class="c1"></span><span class="kd">func</span> <span class="nx">ThirdHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/style.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/navigation_bar.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&#34;Content-Type&#34;</span><span class="p">,</span> <span class="s">&#34;text/html; charset=utf-8&#34;</span><span class="p">)</span>

	<span class="kd">var</span> <span class="nx">queryString</span> <span class="kt">string</span>
	<span class="nx">pathVariables</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">Vars</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
	<span class="nx">queryNumber</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Atoi</span><span class="p">(</span><span class="nx">pathVariables</span><span class="p">[</span><span class="s">&#34;number&#34;</span><span class="p">])</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="nx">queryString</span> <span class="p">=</span> <span class="nx">pathVariables</span><span class="p">[</span><span class="s">&#34;number&#34;</span><span class="p">]</span>
	<span class="p">}</span>
	<span class="nx">fullData</span> <span class="o">:=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
		<span class="s">&#34;NavigationBar&#34;</span><span class="p">:</span> <span class="nx">template</span><span class="p">.</span><span class="nx">HTML</span><span class="p">(</span><span class="nx">navigationBarHTML</span><span class="p">),</span>
		<span class="s">&#34;Number&#34;</span><span class="p">:</span>        <span class="nx">queryNumber</span><span class="p">,</span>
		<span class="s">&#34;StringQuery&#34;</span><span class="p">:</span>   <span class="nx">queryString</span><span class="p">,</span>
	<span class="p">}</span>
	<span class="nx">render</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">thirdViewTpl</span><span class="p">,</span> <span class="s">&#34;third_view&#34;</span><span class="p">,</span> <span class="nx">fullData</span><span class="p">)</span>
<span class="p">}</span></code></pre></div>
<p>The <code>HomeHandler</code> and <code>SecondHandler</code> are very similar, so I will go over how they are set up. Let’s start by talking about how we deal with our CSS files.</p>

<h3 id="http-2-push">HTTP/2 Push</h3>

<p>You might have noticed that at the beginning of the functions, we make calls to push files. We are making use of a new feature introduced in HTTP2 (you can read more about it here), which allows your server to push assets into the client’s browser cache without the need for an additional request. This allows for you cut down the number of requests that are needed from your clients; they make one call and receive everything they need in one go. Not all clients will allow for push to be used, but its a nice feature to have on your server to cut down on the number of client requests. Here is what the <code>push</code> function looks like:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// Push the given resource to the client.
</span><span class="c1"></span><span class="kd">func</span> <span class="nx">push</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">resource</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">pusher</span><span class="p">,</span> <span class="nx">ok</span> <span class="o">:=</span> <span class="nx">w</span><span class="p">.(</span><span class="nx">http</span><span class="p">.</span><span class="nx">Pusher</span><span class="p">)</span>
	<span class="k">if</span> <span class="nx">ok</span> <span class="p">{</span>
		<span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">pusher</span><span class="p">.</span><span class="nx">Push</span><span class="p">(</span><span class="nx">resource</span><span class="p">,</span> <span class="kc">nil</span><span class="p">);</span> <span class="nx">err</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
			<span class="k">return</span>
		<span class="p">}</span>
	<span class="p">}</span>
<span class="p">}</span></code></pre></div>
<p>It should be noted that <code>push</code> functionality is supported in Go 1.8 and higher, so be sure to check that you are using an appropriate version.</p>

<p>All three routes in this example app will be pushing the <code>style.css</code> and <code>navigation_bar.css</code> files. The <code>style.css</code> file contains common styles, which are shared across multiple HTML files in our project. We are also pushing the <code>navigation_bar.css</code> file, because each of these routes will also be rendering a navigation bar.</p>

<p>The navigation bar is passed into the templates via the <code>fullData</code> object, which contains information that we can render into the templates. Before we move on to talk about the <code>ThirdHandler</code> logic, let’s take a look at the HTML template for the <code>HomeHandler</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p"></span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p"></span><span class="p">&gt;</span>
        <span class="c">&lt;!-- Required meta tags --&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;utf-8&#34;</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p"></span><span class="p">&gt;</span>Golang HTML Server<span class="p">&lt;</span><span class="p">/</span><span class="nt">title</span><span class="p">&gt;</span>

        <span class="c">&lt;!-- Bootstrap CSS --&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css&#34;</span> <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p"></span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/static/style.css&#34;</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/static/navigation_bar.css&#34;</span><span class="p"></span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="p">/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;container&#34;</span><span class="p"></span><span class="p">&gt;</span>
            {{.NavigationBar}}

            <span class="p">&lt;</span><span class="nt">h1</span><span class="p"></span><span class="p">&gt;</span>Hello, World!<span class="p">&lt;</span><span class="p">/</span><span class="nt">h1</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="p">/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="p">/</span><span class="nt">body</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- Optional JavaScript --&gt;</span>
    <span class="c">&lt;!-- jQuery first, then Popper.js, then Bootstrap JS --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://code.jquery.com/jquery-3.2.1.slim.min.js&#34;</span> <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p"></span><span class="p">&gt;&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js&#34;</span> <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p"></span><span class="p">&gt;&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js&#34;</span> <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p"></span><span class="p">&gt;&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="p">/</span><span class="nt">html</span><span class="p">&gt;</span></code></pre></div>
<p>In order to access the data that is passed into the <code>render</code> function, you use curly braces: {{ }}. You can see that we are accessing the <code>NavigationBar</code> data that was passing in with the following line:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="p">{{.</span><span class="nx">NavigationBar</span><span class="p">}}</span></code></pre></div>
<p>The ‘.’ is referred to as the <code>cursor</code> or <code>dot</code>; this is important, as it represents your current location within the rendering process. In this example, the <code>dot</code> is at the top level, and has access to the <code>NavigationBar</code> key of the data object. To give an example of how the <code>dot</code> represents your location, consider the following example:</p>

<p>The following data is being passed into the render function:</p>
<div class="highlight"><pre class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
  <span class="nt">&#34;List&#34;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nt">&#34;ID&#34;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nt">&#34;ID&#34;</span><span class="p">:</span> <span class="mi">2</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nt">&#34;ID&#34;</span><span class="p">:</span> <span class="mi">3</span> <span class="p">},</span>
  <span class="p">]</span>
<span class="p">}</span></code></pre></div>
<p>Let’s say we want to iterate over this list, and we want to render it into HTML. Here is what the logic would look like within the template file:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">ul</span><span class="p"></span><span class="p">&gt;</span>
  {{range .List}}
    <span class="p">&lt;</span><span class="nt">li</span><span class="p"></span><span class="p">&gt;</span>{{.ID}}<span class="p">&lt;</span><span class="p">/</span><span class="nt">li</span><span class="p">&gt;</span>
  {{end}}
<span class="p">&lt;</span><span class="p">/</span><span class="nt">ul</span><span class="p">&gt;</span></code></pre></div>
<p>When this template is rendered, the HTML will look like this:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="p">&lt;</span><span class="nt">ul</span><span class="p"></span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">li</span><span class="p"></span><span class="p">&gt;</span>1<span class="p">&lt;</span><span class="p">/</span><span class="nt">li</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">li</span><span class="p"></span><span class="p">&gt;</span>2<span class="p">&lt;</span><span class="p">/</span><span class="nt">li</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">li</span><span class="p"></span><span class="p">&gt;</span>3<span class="p">&lt;</span><span class="p">/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">ul</span><span class="p"></span><span class="p">&gt;</span></code></pre></div>
<p>You can see how the <code>dot</code> represents our location within the rendering process here. For the outermost set of brackets, we have top-level access (we can access the <code>List</code> key). Once we enter the ‘{{range .List}} {{end}}’ block, the cursor moves down a level into <code>List</code>. For more reading on this, check out the documentation <a href="https://golang.org/pkg/text/template">here</a>.</p>

<p>Alright, let’s check out this third handler. Remember that the route for this handler was set up in the handler like so:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">router</span><span class="p">.</span><span class="nx">HandleFunc</span><span class="p">(</span><span class="s">&#34;/third/{number}&#34;</span><span class="p">,</span> <span class="nx">ThirdHandler</span><span class="p">)</span></code></pre></div>
<p>The <code>{number}</code> piece of this is what is import to note; this is a variable that we can access in the handler.</p>

<p>The other thing to remember is that the template for this route was set up to include a map of functions:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="nx">thirdViewTpl</span> <span class="p">=</span> <span class="nx">template</span><span class="p">.</span><span class="nx">Must</span><span class="p">(</span>
  <span class="nx">template</span>
    <span class="p">.</span><span class="nx">New</span><span class="p">(</span><span class="s">&#34;third_view&#34;</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">Funcs</span><span class="p">(</span><span class="nx">thirdViewFuncMap</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">Parse</span><span class="p">(</span><span class="nx">thirdViewHTML</span><span class="p">)</span>
<span class="p">)</span></code></pre></div>
<p>We will discuss the actual map of functions being used in a bit, but with all this in mind, let’s take a look at the handler’s logic itself.</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// ThirdHandler renders the third view template
</span><span class="c1"></span><span class="kd">func</span> <span class="nx">ThirdHandler</span><span class="p">(</span><span class="nx">w</span> <span class="nx">http</span><span class="p">.</span><span class="nx">ResponseWriter</span><span class="p">,</span> <span class="nx">r</span> <span class="o">*</span><span class="nx">http</span><span class="p">.</span><span class="nx">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/style.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/navigation_bar.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">push</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="s">&#34;/static/third_view.css&#34;</span><span class="p">,</span> <span class="s">&#34;style&#34;</span><span class="p">)</span>
	<span class="nx">w</span><span class="p">.</span><span class="nx">Header</span><span class="p">().</span><span class="nx">Set</span><span class="p">(</span><span class="s">&#34;Content-Type&#34;</span><span class="p">,</span> <span class="s">&#34;text/html; charset=utf-8&#34;</span><span class="p">)</span>

	<span class="kd">var</span> <span class="nx">queryString</span> <span class="kt">string</span>
	<span class="nx">pathVariables</span> <span class="o">:=</span> <span class="nx">mux</span><span class="p">.</span><span class="nx">Vars</span><span class="p">(</span><span class="nx">r</span><span class="p">)</span>
	<span class="nx">queryNumber</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">strconv</span><span class="p">.</span><span class="nx">Atoi</span><span class="p">(</span><span class="nx">pathVariables</span><span class="p">[</span><span class="s">&#34;number&#34;</span><span class="p">])</span>
	<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
		<span class="nx">queryString</span> <span class="p">=</span> <span class="nx">pathVariables</span><span class="p">[</span><span class="s">&#34;number&#34;</span><span class="p">]</span>
	<span class="p">}</span>
	<span class="nx">fullData</span> <span class="o">:=</span> <span class="kd">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kd">interface</span><span class="p">{}{</span>
		<span class="s">&#34;NavigationBar&#34;</span><span class="p">:</span> <span class="nx">template</span><span class="p">.</span><span class="nx">HTML</span><span class="p">(</span><span class="nx">navigationBarHTML</span><span class="p">),</span>
		<span class="s">&#34;Number&#34;</span><span class="p">:</span>        <span class="nx">queryNumber</span><span class="p">,</span>
		<span class="s">&#34;StringQuery&#34;</span><span class="p">:</span>   <span class="nx">queryString</span><span class="p">,</span>
	<span class="p">}</span>
	<span class="nx">render</span><span class="p">(</span><span class="nx">w</span><span class="p">,</span> <span class="nx">r</span><span class="p">,</span> <span class="nx">thirdViewTpl</span><span class="p">,</span> <span class="s">&#34;third_view&#34;</span><span class="p">,</span> <span class="nx">fullData</span><span class="p">)</span>
<span class="p">}</span></code></pre></div>
<p>For this template, we are interested in the value passed into the route via the <code>number</code> path variable. To get this value, we pass the request object into <code>mux.Vars()</code>. The call to <code>mux.Vars()</code> returns a map of the path parameters, so we will need to make a call to select the key we want. For this example, we want this value to be a number, so we attempt to convert the string that we get from the call to <code>mux.Vars(r)</code>. You can see that is there is an error, we are setting the <code>queryString</code> variable to be the value of whatever string was passed in. This is so that we can render a different message in the HTML, as you will see.</p>

<p>Let’s take a look at the HTML template for this route:</p>
<div class="highlight"><pre class="chroma"><code class="language-html" data-lang="html"><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;en&#34;</span><span class="p"></span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p"></span><span class="p">&gt;</span>
        <span class="c">&lt;!-- Required meta tags --&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&#34;utf-8&#34;</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;viewport&#34;</span> <span class="na">content</span><span class="o">=</span><span class="s">&#34;width=device-width, initial-scale=1, shrink-to-fit=no&#34;</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">title</span><span class="p"></span><span class="p">&gt;</span>Golang HTML Server<span class="p">&lt;</span><span class="p">/</span><span class="nt">title</span><span class="p">&gt;</span>

        <span class="c">&lt;!-- Bootstrap CSS --&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css&#34;</span> <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p"></span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/static/style.css&#34;</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/static/navigation_bar.css&#34;</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&#34;stylesheet&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/static/third_view.css&#34;</span><span class="p"></span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="p">/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p"></span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;container&#34;</span><span class="p"></span><span class="p">&gt;</span>
            {{.NavigationBar}}

            <span class="p">&lt;</span><span class="nt">h1</span><span class="p"></span><span class="p">&gt;</span>Rendering Data<span class="p">&lt;</span><span class="p">/</span><span class="nt">h1</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">h4</span><span class="p"></span><span class="p">&gt;</span>This page takes the integer passed in and determines if it is odd or even<span class="p">&lt;</span><span class="p">/</span><span class="nt">h4</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;result-box&#34;</span><span class="p"></span><span class="p">&gt;</span>
                {{if .StringQuery}}
                    <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;result-underlined&#34;</span><span class="p"></span><span class="p">&gt;</span>You didn&#39;t enter an integer. This is what was entered:<span class="p">&lt;</span><span class="p">/</span><span class="nt">h2</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h3</span><span class="p"></span><span class="p">&gt;</span>{{.StringQuery}}<span class="p">&lt;</span><span class="p">/</span><span class="nt">h3</span><span class="p">&gt;</span>
                {{else}}
                    <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;result-underlined&#34;</span><span class="p"></span><span class="p">&gt;</span>The number entered is:<span class="p">&lt;</span><span class="p">/</span><span class="nt">h2</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h3</span><span class="p"></span><span class="p">&gt;</span>{{.Number}}<span class="p">&lt;</span><span class="p">/</span><span class="nt">h3</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h2</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;result-underlined&#34;</span><span class="p"></span><span class="p">&gt;</span>This number is:<span class="p">&lt;</span><span class="p">/</span><span class="nt">h2</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">h3</span><span class="p"></span><span class="p">&gt;</span>{{.Number | formatOddOrEven}}<span class="p">&lt;</span><span class="p">/</span><span class="nt">h3</span><span class="p">&gt;</span>
                {{end}}
            <span class="p">&lt;</span><span class="p">/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="p">/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="p">/</span><span class="nt">body</span><span class="p">&gt;</span>

    <span class="c">&lt;!-- Optional JavaScript --&gt;</span>
    <span class="c">&lt;!-- jQuery first, then Popper.js, then Bootstrap JS --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://code.jquery.com/jquery-3.2.1.slim.min.js&#34;</span> <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p"></span><span class="p">&gt;&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js&#34;</span> <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-b/U6ypiBEHpOf/4+1nzFpr53nxSS+GLCkfwBdFNTxtclqqenISfwAzpKaMNFNmj4&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p"></span><span class="p">&gt;&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&#34;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/js/bootstrap.min.js&#34;</span> <span class="na">integrity</span><span class="o">=</span><span class="s">&#34;sha384-h0AbiXch4ZDo7tp9hKZ4TsHbi047NrKGLO3SEJAg45jXxnGIfYzk4Si90RDIqNm1&#34;</span> <span class="na">crossorigin</span><span class="o">=</span><span class="s">&#34;anonymous&#34;</span><span class="p"></span><span class="p">&gt;&lt;</span><span class="p">/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="p">/</span><span class="nt">html</span><span class="p">&gt;</span></code></pre></div>
<p>You can see that we are checking for the presence of <code>QueryString</code> in the data that is getting passed in; if this value is not nil, then we know that the user did not supply a number. If <code>QueryString</code> is nil, then we can display the HTML that will show the number entered and whether or not it is even or odd. The final piece to look at here is the following line:</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="p">{{.</span><span class="nx">Number</span> <span class="p">|</span> <span class="nx">formatOddOrEven</span><span class="p">}}</span></code></pre></div>
<p>That map of functions we included with the template, when it was initialized, comes into play here. Let’s take a look at that map of functions, which can be found in <code>third_view.go</code></p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="c1">// ThirdViewFormattingFuncMap returns a map of functions
</span><span class="c1">// that will be used by the Third View template
</span><span class="c1"></span><span class="kd">func</span> <span class="nx">ThirdViewFormattingFuncMap</span><span class="p">()</span> <span class="nx">template</span><span class="p">.</span><span class="nx">FuncMap</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">template</span><span class="p">.</span><span class="nx">FuncMap</span><span class="p">{</span>
		<span class="s">&#34;formatOddOrEven&#34;</span><span class="p">:</span> <span class="nx">formatOddOrEven</span><span class="p">,</span>
	<span class="p">}</span>
<span class="p">}</span>

<span class="kd">func</span> <span class="nx">formatOddOrEven</span><span class="p">(</span><span class="nx">number</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
	<span class="nx">remainder</span> <span class="o">:=</span> <span class="nb">int</span><span class="p">(</span><span class="nx">math</span><span class="p">.</span><span class="nx">Abs</span><span class="p">(</span><span class="nb">float64</span><span class="p">(</span><span class="nx">number</span><span class="p">)))</span> <span class="o">%</span> <span class="mi">2</span>
	<span class="k">if</span> <span class="nx">remainder</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">{</span>
		<span class="k">return</span> <span class="s">&#34;Odd&#34;</span>
	<span class="p">}</span>
	<span class="k">return</span> <span class="s">&#34;Even&#34;</span>
<span class="p">}</span></code></pre></div>
<p>We can see that the function map defined in <code>ThirdViewFormattingFuncMap</code> contains a function called <code>formatOddOrEven</code>; by piping the value of <code>.Number</code> into this function, we are calling <code>formatOddOrEven(Number)</code> and rendering the string it returns.</p>

<p>As a final note on rending HTML templates, it is best to keep the HTML file itself relatively simple, and keep most of the logic on the server-side. The Go template package provides building blocks (conditionals, comparison operators, basic iteration, etc), but most of the heavy lifting should be handled outside of the HTML itself.</p>

<h3 id="running-the-server">Running the Server</h3>

<p>Okay, now that we have a better understanding of how this project it set up, let’s build it and see it in action. Before we do this, we need to do one more thing. In order for our templates to be initialized, we need to use <code>jteeuwen/go-bindata</code> to generate a file with all of our HTML template and CSS information. First we need to install the library:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">go get -u github.com/jteeuwen/go-bindata/...</code></pre></div>
<p>Next, we run the go-bindata tool to generate our file. Do this in the project’s root directory.</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">go-bindata -o<span class="o">=</span>assets/bindata.go --nocompress --nometadata --pkg<span class="o">=</span>assets templates/... static/...</code></pre></div>
<p>Check that the <code>bindata.go</code> file was successfully generated in the assets folder of the project. Finally run this command to start the server:</p>
<div class="highlight"><pre class="chroma"><code class="language-bash" data-lang="bash">go build <span class="o">&amp;&amp;</span> ./golang-html-template-tutorial</code></pre></div>
<p>To see it running, point your browser to whatever the host is (by default, this should be <code>localhost:5000</code>)</p>

<p>We are only really just scratching the surface of some of the cool things you can do with Go, so consider this a very basic starting point. That being said, we hope that this can help you on your way to building your own Go projects!</p>

                            </article>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>



    </main>

</body>

<footer>
    
    <div class="get-in-touch-container">
    <div class="container">
        <div class="row get-in-touch">
            <div class="col-12 col-md-6 content-col d-flex flex-column justify-content-start align-items-center">
                <p class="get-in-touch-header mb-0">Ready to get started</p>
                <p class="get-in-touch-content">Let&#39;s talk about your project</p>
            </div>
            <div class="col-12 col-md-6 btn-col d-flex align-items-center">
                <button type="button" href="https://taylorhalliday.typeform.com/to/ji75xl" class="btn get-in-touch-btn typeform-share">get in touch</button>
            </div>
        </div>
    </div>
</div>
    <div class="container footer-container py-5" id="container">
        <div class="row">
            
            <div class="col">
                <a class="navbar-brand mb-5 mt-2" href="https://meshstudio.io/">
                    <img class="img-fluid main-logo" src="/images/site/meshlogo-white-vector.svg" alt="Home" />
                </a>
            </div>
        </div>
        <div class="row">

            
            <div class="col-6 col-md-3 footer-list">
                <h5>Contact</h5>
                <ul class="list-unstyled text-small">
                    <li>
                        3621 Stone Way N Suite G
                    </li>
                    <li>
                        Seattle, WA 98103
                    </li>
                    <li>
                        info@meshstudio.io
                    </li>
                </ul>
            </div>

            
            <div class="col-6 col-md-3 footer-list nav-list">
                <h5>Pages</h5>
                <ul class="list-unstyled text-small">

                    <ul class="footer-nav">
                        
                        <li class="nav-item">
                            <a class="nav-link pt-1 pb-1" href="/">Home</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link pt-1 pb-1" href="/work/">Work</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link pt-1 pb-1" href="/services/">Services</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link pt-1 pb-1" href="/about/">About</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link pt-1 pb-1" href="/careers/">Careers</a>
                        </li>
                        
                        <li class="nav-item">
                            <a class="nav-link pt-1 pb-1" href="/blog/">Blog</a>
                        </li>
                        
                    </ul>
                </ul>
            </div>

            
            <div class="col-12 col-md-4 offset-md-2 footer-list">
                
                    <h5>Latest Blog Post</h5>
                    
                    <a class="blog-title d-block" href="/blog/2019-06-29-static-hosting-with-aws/">The Complete Guide to Static Hosting with AWS</a>
                    <a class="blog-sub-title d-block pt-2" href="/blog/2019-06-29-static-hosting-with-aws/">AWS is Mesh&#39;s preferred platform for quickly and securely hosting static websites.</a>
                
            </div>
        </div>
    </div>
</footer>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>


<script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script>
<script src="/js/googleAnalytics.js"></script>
<script src="/js/typeform.js"></script>
<script src="/js/mailchimp.js"></script>


</html>